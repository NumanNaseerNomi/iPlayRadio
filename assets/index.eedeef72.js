import{R as i,_ as r}from"./RadioPlayer.56c51c6a.js";import{_ as c,c as f,a as l,b as d,o as C}from"./entry.e59b5d3c.js";const u={data(){return{allChannelsList:[],suggestedChannelsList:[],isLoadingSuggestedChannels:!1,isLoadingAllChannels:!1,allChannelsOffset:0,suggestedChannelsOffset:0,canLoadMoreAllChannels:!0,canLoadMoreSuggestedChannels:!0,ipInfo:null}},created(){this.getAllChannels(),this.getSuggestedChannels()},methods:{async getAllChannels(){this.isLoadingAllChannels=!0,this.allChannelsList=await new i().getAllStations({offset:0,limit:50,order:"random"}),this.isLoadingAllChannels=!1},async getSuggestedChannels(){this.isLoadingSuggestedChannels=!0,await this.updateIpInfo(),this.suggestedChannelsList=await new i().searchStations({countryCode:this.ipInfo.country,offset:0,limit:50,order:"random"}),this.isLoadingSuggestedChannels=!1},async loadMoreAllChannels(){if(this.canLoadMoreAllChannels){this.isLoadingAllChannels=!0;const n=this.allChannelsList.length,s=await new i().getAllStations({offset:++this.allChannelsOffset,limit:50,order:"random"});this.allChannelsList=[...this.allChannelsList,...s.filter(e=>!this.allChannelsList.some(t=>t.id===e.id))],this.isLoadingAllChannels=!1,this.canLoadMoreAllChannels=this.allChannelsList.length>n}},async loadMoreSuggestedChannels(){if(this.canLoadMoreSuggestedChannels){this.isLoadingSuggestedChannels=!0;const n=this.suggestedChannelsList.length,s=await new i().searchStations({countryCode:this.ipInfo.country,offset:++this.suggestedChannelsOffset,limit:50,order:"random"});this.suggestedChannelsList=[...this.suggestedChannelsList,...s.filter(e=>!this.suggestedChannelsList.some(t=>t.id===e.id))],this.isLoadingSuggestedChannels=!1,this.canLoadMoreSuggestedChannels=this.suggestedChannelsList.length>n}},async updateIpInfo(){var s;this.ipInfo=JSON.parse(localStorage.getItem("ipInfo"));const n=Math.floor((new Date-new Date((s=this.ipInfo)==null?void 0:s.updatedAt))/864e5);if(!this.ipInfo||n>7)try{const e=await fetch("https://ipinfo.io/json");if(e.ok)this.ipInfo=await e.json(),this.ipInfo.updatedAt=new Date,localStorage.setItem("ipInfo",JSON.stringify(this.ipInfo));else throw new Error("Failed to fetch IP information")}catch{this.ipInfo=this.ipInfo??{country:"US"}}}}},L={class:"container"},p={class:"row"},m={class:"col-lg-6 mb-4"},S={class:"col-lg-6 mb-4"};function I(n,s,e,t,a,o){const h=r;return C(),f("div",L,[l("div",p,[l("div",m,[d(h,{listTitle:"Suggested Channels",channelsList:a.suggestedChannelsList,isLoading:a.isLoadingSuggestedChannels,onLoadMore:s[0]||(s[0]=g=>o.loadMoreSuggestedChannels()),style:{"max-height":"70vh"}},null,8,["channelsList","isLoading"])]),l("div",S,[d(h,{listTitle:"All Channels",channelsList:a.allChannelsList,isLoading:a.isLoadingAllChannels,onLoadMore:s[1]||(s[1]=g=>o.loadMoreAllChannels()),style:{"max-height":"70vh"}},null,8,["channelsList","isLoading"])])])])}const w=c(u,[["render",I]]);export{w as default};
